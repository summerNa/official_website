<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/register_email.css">
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <title>邮箱注册</title>
</head>

<body>
  <div class="header_wrap">
    <div class="header">
      <a href="home.html" class="left">
        <img src="img/common/logo.png" alt="">
      </a>
      <ul class="middle">
        <li>
          <a href="home.html">首页</a>
        </li>
        <li>
          <a href="product.html">产品</a>
        </li>
        <li>
          <a href="introduce.html">关于我们</a>
        </li>
      </ul>
      <div class="right">
        <a class="click_im_area" href="javascript:;">
          <div class="im_box">
            <img src="img/common/yun.png" alt="">
          </div>
          <p class="in">导入</p>
        </a>
        <ul class="loginYet">
          <li class="loginY">
            <a class="usernameAndLogin" href="login.html">登录</a>
          </li>
          <li>
            <div class="line"></div>
          </li>
          <li class="loginY">
            <a class="logoutAndRegister" href="register.html">注册</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="con_wrap">
    <div class="con">
      <a class="email" href="register.html">手机注册</a>
      <div class="top">邮箱注册</div>
      <div class="detail">
        <form action="">
          <div class="input_box">
            <!-- <div class="area">
              <div class="select" id="selectbox1">
                <p id="selectValue">+86</p>
                <span class="jiao"></span>
              </div>
              <ul class="option hide" id="group">
                <li><a href="javascript:;">+66</a></li>
                <li><a href="javascript:;">+88</a></li>
              </ul>
            </div> -->
            <!-- <input type="text" class="phone" placeholder="手机号" id="phoneInput" autocomplete="off"/> -->
            <!-- <div class="input_box"> -->
              <input type="text" class="pass" placeholder="请输入您的邮箱" id="phoneInput" autocomplete="off"/>
            <!-- </div> -->
          </div>
          <div class="input_box">
            <input type="password" placeholder="6-20位密码，字母、数字、符号都可以" class="pass" id="password" autocomplete="off">
          </div>
          <div class="input_box yes">
            <input type="checkbox" id="isAgree"/>我已阅读并接受<span>用户协议</span>
          </div>
          <a href="javascript:;" class="input_box register" id="register">
            注册
          </a>
          <p class="tips">*信息有误！</p>
        </form>
      </div>
    </div>
  </div>
  <div class="bottom_wrap">
    <div class="bottom">沪ICP备18026697号/上海市公安局徐汇分局备案编号：1102323237987987</div>
  </div>
</body>
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/common.js"></script>
<script>
  $(document).ready(function () {
    var regPhone = /^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/;  // 手机号正则表达式
    var phone;
    var password;
    var verify_code;
    var checked;
    var params;
    var timer;
    var flag = true;

    var whdef = 100 / 1920; // 表示1920的设计图,使用100PX的默认值
    var wH = window.innerHeight; // 当前窗口的高度
    var wW = window.innerWidth; // 当前窗口的宽度
    var rem = wW * whdef; // 以默认比例值乘以当前窗口宽度,得到该宽度下的相应FONT-SIZE值
    $('html').css('font-size', rem + "px");

    $(window).resize(function () {
      wH = window.innerHeight;
      wW = window.innerWidth;
      rem = wW * whdef;
      $('html').css('font-size', rem + "px");
    });

    // 模仿下拉框
    $('#selectbox1').on('click', function () {
      $('#group').removeClass('hide');
    })

    // 下拉选择
    $('#group li a').on('click', function () {
      $('#selectValue').html($(this).html());
      $('#group').addClass('hide');
    });

    function isParamsRight() {
      phone = $('#phoneInput').val();
      password = $('#password').val();
      checked = $('#isAgree').is(':checked');
      if (phone && regPhone.test(phone) && password.length >=6 && password.length <=20 && checked) {
        $('#register').addClass('actived');
      } else {
        $('#register').removeClass('actived');
      }
    }

    $("#phoneInput, #code, #password").keyup(function () {
      isParamsRight();
    });

    $("#phoneInput, #code, #password").focus(function () {
      $('.tips').removeClass('actived');
    });

    $("input[type='checkbox']").on('click',function(){
      isParamsRight();
    });

    // 注册
    $('#register').on('click', function () {
      phone = $('#phoneInput').val();
      password = $('#password').val();
      checked = $('#isAgree').is(':checked');
      if (phone && regPhone.test(phone) && password && (6 <= password.length <= 20) &&  checked) {
        params = encodeURI('{"password":"' + password + '","phone_number":"' + phone + '","verify_code":"' + verify_code + '","invite_code":""}');
        $.ajax({
          url: 'http://api.xiaoyu.chat/live/Devicepassport/register?header={"os{"os":"web","reqtime":"1538122392411","sign":"","v"}&body=' + params,
          type: 'GET',
          dataType: 'JSON',
          beforeSend: function (request) {
          },
          success: function (data) {
            if(data.header.retStatus !== 200) {
              $('.tips').addClass('actived');
              $('.tips').html(data.header.retMessage);
            }
          },
          error: function (error) {
            // console.log(111)
          }
        });
      }
    });

  })

</script>

</html>