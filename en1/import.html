<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image/x-icon" href="../favicon.ico" />
  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/import.css?2">
  <title>导入</title>
</head>

<body>
  <div class="header_wrap">
    <div class="header">
      <a href="home.html" class="left">
        <img src="../img/common/logo.png" alt="">
      </a>
      <ul class="middle">
        <li>
          <a href="home.html">首页</a>
        </li>
        <li>
          <a href="product.html">产品</a>
        </li>
        <li>
          <a href="introduce.html">关于我们</a>
        </li>
        <li class="">
          <a class="list" href="javascript:;">小宇矿机</a>
        </li>
      </ul>
      <div class="right">
        <!-- <a class="click_im_area" href="javascript:;">
          <div class="im_box">
            <img src="img/common/yun.png" alt="">
          </div>
          <p class="in">导入</p>
        </a> -->
        <ul class="loginYet">
          <li class="language">
            <a class="en" href="">ENGLISH</a>
          </li>
          <li class="loginY">
            <a class="usernameAndLogin" href="login.html">登录</a>
          </li>
          <li>
            <div class="line"></div>
          </li>
          <li class="loginY">
            <a class="logoutAndRegister" href="register.html">注册</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="content_wrap">
    <div class="content">
      <!-- <div class="select_box">
        <div class="left">
          <div class="fileinput-button" type="button">
            <span>导入文件</span>
            <img src="img/common/import_icon.png" alt="">
          </div>
          <input type="file" id="upload">
        </div>
        <div class="right">
          <div class="select_option">
            <div class="select">
              <p id="selectValue">选择分组</p>
              <span class="jiao"></span>
            </div>
            <ul class="option hide" id="group">
            </ul>
          </div>
          <div class="new">新建分组</div>
        </div>
      </div> -->
      <div class="area">
        <!-- <div class="bar">
          <img src="img/common/smile_icon.png" alt="">
          <p>玩客云账号授权</p>
        </div>
        <div class="con">
          <p class="title">授权小宇登录并获取您的玩客云数据</p>
          <textarea id="text_area" class="input_box" placeholder="请填写需要授权的账号和密码，格式：账号#密码。每个账号密码间换行分隔。"></textarea>
          <div class="yes">
            <input type="checkbox" id="isAgree" checked />我已阅读并同意<span>《玩客云账号授权服务协议》</span>
          </div>
          <a href="javascript:;" class="agree actived" id="agree">登录并授权</a>
          <p class="t">小宇将获得以下权限：</p>
          <div class="options">
            <div class="brief">
              <input type="checkbox" id="one" checked />
              <p>获取您的玩客云账号、绑定设备信息</p>
              <img class="arrow" src="img/common/arrow.png" alt="">
            </div>
            <ul class="detail none">
              <li>1、修改备注名</li>
              <li>2、弹出磁盘</li>
              <li>3、重启设备</li>
            </ul>
          </div>
          <div class="options">
            <div class="brief">
              <input type="checkbox" id="two" checked />
              <p>获取您的玩客云链克奖励信息及操作</p>
              <img class="arrow" src="img/common/arrow.png" alt="">
            </div>
            <ul class="detail none">
              <li>1、修改备注名</li>
              <li>2、弹出磁盘</li>
              <li>3、重启设备</li>
            </ul>
          </div>
          <div class="options">
            <div class="brief">
              <input type="checkbox" id="three" checked />
              <p>获取您的玩客云设备操作权限</p>
              <img class="arrow down" src="img/common/arrow.png" alt="">
            </div>
            <ul class="detail">
              <li>1、修改备注名</li>
              <li>2、弹出磁盘</li>
              <li>3、重启设备</li>
            </ul>
          </div>
        </div> -->
        <iframe id="a" scrolling="no" width="100%" height="800px" src="" frameborder="0"></iframe>
      </div>
    </div>
  </div>
  <div class="footer_wrap">
    <div class="footer">
      <ul class="about">
        <li class="title">关于宇监</li>
        <li>公司咨询</li>
        <li>合作机会</li>
        <li>加入我们</li>
      </ul>
      <ul class="contact">
        <li class="title">联系宇监</li>
        <li class="QQ"><span>QQ群</span> <img src="../img/common/contact.png" alt=""></li>
        <li><span class="email">邮箱</span> <span>surpport@xiaoyu.chat</span></li>
      </ul>
      <ul class="wechart">
        <li class="title">微信公众号</li>
        <li><img src="../img/common/code.jpg" alt=""></li>
      </ul>
    </div>
    <div class="icp">
      沪ICP备18026697号
    </div>
  </div>
  <div class="alert_wrap">
    <div class="con">
      <div class="top">
        <p>新建分组</p>
        <img id="close" src="../img/common/close.png" alt="">
      </div>
      <div class="input">
        <div class="line">
          <p>分组名称：</p>
          <input type="text" id="groupInput">
        </div>
        <div class="btn_wrap">
          <a class="add" id="addGroup">添加</a>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="../js/jquery-1.9.1.min.js"></script>
<script src="../js/common.js"></script>
<script>
  $(document).ready(function () {
    var params;
    var LI = '';

    var whdef = 100 / 1920; // 表示1920的设计图,使用100PX的默认值
    var wH = window.innerHeight; // 当前窗口的高度
    var wW = window.innerWidth; // 当前窗口的宽度
    var rem = wW * whdef; // 以默认比例值乘以当前窗口宽度,得到该宽度下的相应FONT-SIZE值
    $('html').css('font-size', rem + "px");

    $(window).resize(function () {
      wH = window.innerHeight;
      wW = window.innerWidth;
      rem = wW * whdef;
      $('html').css('font-size', rem + "px");
    });

    params = encodeURI('{"monitor_userid":"' + isLogin.userid + '","client_type":1}');
    $.ajax({
      url: 'http://api.xiaoyu.chat/live/devicemanager/getAuthPage?header={"os{"os":"web","reqtime":"1538121291086","sign":"","v"}&body=' + params,
      type: 'GET',
      dataType: 'JSON',
      beforeSend: function (request) {
      },
      success: function (data) {
        // $(".area").append("<iframe id='a' scrolling='no' width='100%' height='800px' src='"+data.responseText+"'></iframe>");
        $("#a").attr('src', data.responseText);
      },
      error: function (error) {
        // $(".area").append("<iframe id='a' scrolling='no' width='100%' height='800px' src='"+error.responseText+"'></iframe>");
        $("#a").attr('src', error.responseText);
      }
    });

    $("#isAgree, #one, #two, #three").on('change', function () {
      if (!($('#isAgree').is(':checked') && $('#one').is(':checked') && $('#two').is(':checked') && $('#three').is(':checked'))) {
        $('#agree').removeClass('actived');
      } else {
        $('#agree').addClass('actived');
      }
    });

    $("#upload").on("change", function () {
      var objFile = $("#upload");
      if (objFile.value == "") {
        alert("不能空")
      }

      var files = $('#upload').prop('files');//获取到文件列表
      if (files.length == 0) {
        alert('请选择文件');
      } else {
        var reader = new FileReader();//新建一个FileReader
        reader.readAsText(files[0], "GB2312");//读取文件 
        reader.onload = function (evt) { //读取完文件之后会回来这里
          var fileString = evt.target.result; // 读取文件内容
          // $('#a').contents().find(".textarea-type").val(fileString);
          // $('#a')[0].contentWindow.postMessage(fileString, '*');

        }
      }
    })

    // 模仿下拉框
    $('#selectValue').on('click', function () {
      $('#group').removeClass('hide');
    })

    // 下拉选择
    $(document).on('click', '#group li a', function (e) {

      $('#selectValue').html($(this).html());
      $('#group').addClass('hide');

    });

    $('.new').on('click', function () {
      $('.alert_wrap').addClass('block');
    })

    $('#close').on('click', function () {
      $('.alert_wrap').removeClass('block');
    })

    $('.arrow').on('click', function () {
      if ($(this).parent().next().hasClass('none')) {
        $(this).parent().next().removeClass('none');
        $(this).addClass('down');
      } else {
        $(this).parent().next().addClass('none');
        $(this).removeClass('down');
      }
    })

    // 获取用户名下分组
    // params = encodeURI('{"monitor_userid":"' + isLogin.userid + '","session_id":"' + isLogin.session_id + '"}');
    // $.ajax({
    //   url: 'http://api.xiaoyu.chat/live/Devicemanager/getDeviceGroup?header={"os{"os":"web","reqtime":"1538121291086","sign":"","v"}&body=' + params,
    //   type: 'GET',
    //   dataType: 'JSON',
    //   beforeSend: function (request) {
    //   },
    //   success: function (data) {
    //     // 循环
    //     for (var i = 0; i < data.body.group_list.length; i++) {
    //       LI += '<li><a href="javascript:;">' + data.body.group_list[i].group_name + '</a></li>';
    //     }
    //     $('#group').append(LI);
    //     LI = '';
    //   },
    //   error: function (error) {
    //   }
    // });

    $('#addGroup').on('click', function () {
      if ($('#groupInput').val()) {
        params = encodeURI('{"monitor_userid":"' + isLogin.userid + '","session_id":"' + isLogin.session_id + '","group_name":"' + $('#groupInput').val() + '"}');
        $.ajax({
          url: 'http://api.xiaoyu.chat/live/Devicemanager/AddDeviceGroup?header={"os{"os":"web","reqtime":"1538121291086","sign":"","v"}&body=' + params,
          type: 'GET',
          dataType: 'JSON',
          beforeSend: function (request) {
          },
          success: function (data) {
            if (data.header.retStatus === 200) {
              $('#group').append('<li><a href="javascript:;">' + $('#groupInput').val() + '</a></li>');
              $('.alert_wrap').removeClass('block');
            }
            console.log(data)
          },
          error: function (error) {
            console.log(error)
          }
        });
      }
    });

  });


</script>

</html>